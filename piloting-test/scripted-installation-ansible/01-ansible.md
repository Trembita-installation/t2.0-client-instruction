# üì¶ –Ü–Ω—Å—Ç–∞–ª—è—Ü—ñ—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤ —á–µ—Ä–µ–∑ Ansible-playbook

–¶–µ–π —Ä–æ–∑–¥—ñ–ª –æ–ø–∏—Å—É—î, —è–∫ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ —Å–∏—Å—Ç–µ–º–∏ –¢—Ä–µ–º–±—ñ—Ç–∞ 2.0 –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤ –Ω–∞ –±–∞–∑—ñ **Ansible**.

> ‚ö†Ô∏è **–£–≤–∞–≥–∞!** –ü–µ—Ä–µ–¥ –ø–æ—á–∞—Ç–∫–æ–º —ñ–Ω—Å—Ç–∞–ª—è—Ü—ñ—ó –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å, —â–æ –≤–∏–∫–æ–Ω–∞–Ω–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ –∫—Ä–æ–∫–∏, —è–∫—ñ –æ–ø–∏—Å–∞–Ω—ñ –≤ [README](README.md) —Ü—ñ—î—ó –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó.

> ## üìå –ü—Ä–∏–º—ñ—Ç–∫–∞
>–Ü–Ω—Å—Ç–∞–ª—è—Ü—ñ—è –º–æ–∂–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏—Å—å —è–∫ **–æ–∫—Ä–µ–º–æ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞**, —Ç–∞–∫ —ñ **–æ–¥—Ä–∞–∑—É –¥–ª—è –≤—Å—ñ—Ö** (—á–µ—Ä–µ–∑ –æ–±‚Äô—î–¥–Ω–∞–Ω–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π –∞–±–æ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è playbook-—Ñ–∞–π–ª—ñ–≤).

## üîß –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏, —è–∫—ñ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—é—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Ansible-playbook

- **UXP Security Server (–®–ë–û)**
- **MinIO**
- **ELK**
- **Graylog**
- **Zabbix**
- **FILEBEAT (–¥–ª—è MonHub —Ä—ñ—à–µ–Ω–Ω—è)**

## ‚ö†Ô∏è –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏, —è–∫—ñ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—é—Ç—å—Å—è –≤—Ä—É—á–Ω—É:

- **Zabbix-agent (–¥–ª—è MonHub —Ä—ñ—à–µ–Ω–Ω—è)**

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó

| –§–∞–π–ª / –î–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è                         | –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è                                      |
|-------------------------------------------|--------------------------------------------------|
| `ansible.cfg`                             | –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è Ansible                             |
| `inventories/sample/infra.yaml`           | –°–ø–∏—Å–æ–∫ —Å–µ—Ä–≤–µ—Ä—ñ–≤ (IP, hostname)                   |
| `group_vars/all.yaml`                     | –ó–º—ñ–Ω–Ω—ñ: –ø–∞—Ä–æ–ª—ñ, –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ —Ç–æ—â–æ                 |
| `*_install.yaml`                          | –ü–ª–µ–π–±—É–∫–∏ –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –æ–∫—Ä–µ–º–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤    |

--- 

## ‚öôÔ∏è –í–∏–º–æ–≥–∏

- –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π **Ansible 2.12+**
  > **–ù–∞–ø—Ä–∏–∫–ª–∞–¥**, –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è Ansible –º–æ–∂–Ω–∞ —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è —Ç–∞–∫–æ—é –∫–æ–º–∞–Ω–¥–æ—é:  
  >```bash
  >sudo apt update && sudo apt install -y ansible
  >```
  
- SSH-–¥–æ—Å—Ç—É–ø –ø–æ **–∫–ª—é—á—É** –¥–æ —Ü—ñ–ª—å–æ–≤–∏—Ö —Å–µ—Ä–≤–µ—Ä—ñ–≤
- –î–æ—Å—Ç—É–ø –¥–æ –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç—É –∑ —Ü—ñ–ª—å–æ–≤–∏—Ö —Å–µ—Ä–≤–µ—Ä—ñ–≤

## üöÄ –ö—Ä–æ–∫–∏ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

1. **–ü—ñ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞ —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ –≤–∏–º–æ–≥–∞–º:**
    - [–°–∫–ª–∞–¥, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∞ –º—ñ–Ω—ñ–º–∞–ª—å–Ω—ñ –∞–ø–∞—Ä–∞—Ç–Ω—ñ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤](../manual-installation/01-env-components.md))
    - [–ú–µ—Ä–µ–∂–µ–≤–∞ —Å—Ö–µ–º–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è](../manual-installation/02-network-diagram.md)


2. **–°—Ç–≤–æ—Ä–∏—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–æ –ø–∞–ø–∫—É** –∑ –Ω–∞–∑–≤–æ—é `t2_instal`

3. **–ü–µ—Ä–µ–π—Ç–∏** –≤ –ø–∞–ø–∫—É `t2_instal`

4. **–ö–ª–æ–Ω—É–≤–∞—Ç–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π**  

   ```bash
   git clone https://github.com/Trembita-installation/t2.0-client-deployment.git .
   ```
5. **–ü–µ—Ä–µ–π–º–µ–Ω—É–π—Ç–µ –ø–∞–ø–∫—É** `sample` ( /t2.0-client-deployment.git/inventories/**sample** ) –≤ –Ω–∞–∑–≤—É –í–∞—à–æ–≥–æ –ø—Ä–æ—î–∫—Ç—É. –Ü –≤—ñ–¥ –Ω–∞–∑–≤–∏ –í–∞—à–æ–≥–æ –ø—Ä–æ—î–∫—Ç—É –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –Ω–∞–∑–≤—É –≤ –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö —Ñ–∞–π–ª–∞—Ö /t2.0-client-deployment.git/inventories/_name_your_project_

6. **–ü–µ—Ä–µ–π—Ç–∏ –¥–æ —Ñ–∞–π–ª—É** `infra_yaml` ( /inventories/_name_your_project_/infra_yaml ) —á–µ—Ä–µ–∑ —Ä–µ–¥–∞–∫—Ç–æ—Ä –∞–±–æ –∫–æ–Ω—Å–æ–ª—å

7. **–í–ø–∏—Å–∞—Ç–∏** –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ `ip` —Ç–∞ `hostname` –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏—Ö —Å–µ—Ä–≤–µ—Ä—ñ–≤ —Ç–∞ –∑–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω–∏

   <img width="406" alt="image" src="https://github.com/user-attachments/assets/2acc046a-db76-4f17-8186-afe6eb43acfe" />

8. **–ü–µ—Ä–µ–π—Ç–∏ –¥–æ —Ñ–∞–π–ª—É** `all.yaml` ( /inventories/_name_your_project_/group_vars/all.yaml ) —Ç–∞ –≤–ø–∏—Å–∞—Ç–∏ `–ª–æ–≥—ñ–Ω–∏` —ñ `–ø–∞—Ä–æ–ª—ñ` –¥–ª—è –ø–æ–¥–∞–ª—å—à–∏—Ö –¥–æ—Å—Ç—É–ø—ñ–≤ –¥–æ –≤–µ–±—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ–≤ —Ç–∞ —ñ–Ω—à–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤

> ‚ö†Ô∏è **–£–≤–∞–≥–∞!** –î–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è **FILEBEAT** –≤ —Ñ–∞–π–ª—ñ `all.yaml` —Ç—Ä–µ–±–∞ –¥–æ–¥–∞—Ç–∏ `id`, —è–∫—ñ –Ω–∞–¥–∞—î –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä —Å–∏—Å—Ç–µ–º–∏ –¢—Ä–µ–º–±—ñ—Ç–∞
> ```bash
> ######## FILEBEAT ###############
> project_id: "PROVIDED_BY_SUPPORT"
> filebeat_id: "PROVIDED_BY_SUPPORT"
> filebeat_api_key: "PROVIDED_BY_SUPPORT"
> #################################
> ```

> ‚ö†Ô∏è **–£–≤–∞–≥–∞!** –ü—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è –∑–º—ñ–Ω–∞ —ñ–º–µ–Ω —é–∑–µ—Ä—ñ–≤, –æ–∫—Ä—ñ–º —é–∑–µ—Ä–∞ –¥–ª—è **SS**
  
  <img width="675" alt="image" src="https://github.com/user-attachments/assets/6d453482-5acc-4d6d-a404-e451c3eb05e2" />

9. **–ü–µ—Ä–µ–π—Ç–∏ –¥–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó** —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å –∑ Ansible-playbook 

   ```bash
   cd t2_instal/
   ```

10. **–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω—ñ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä—ñ–≤**

    ```bash
    ansible -i inventories/_name_your_project_/infra.yaml all -m ping --private-key=/path/to/ssh_private_key -u username
    ```
   
11. **–î–æ–¥–∞—Ç–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π** –Ω–∞ –≤—Å—ñ —Å–µ—Ä–≤–µ—Ä–∏
   
   ```bash
   ansible-playbook  -u  your user -i inventories/_name_your_project_/infra.yaml --private-key=/path/your/key repa.yaml
   ```
> ‚ÑπÔ∏è **–ü—Ä–∏–º—ñ—Ç–∫–∞:**  `/path/your/key` - —Ü–µ —à–ª—è—Ö –¥–æ –í–∞—à–æ–≥–æ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –∑ —è–∫–∏–º –í–∏ –ø—ñ–¥–∫–ª—é—á–∞—î—Ç–µ—Å—å –¥–æ —Å–µ—Ä–≤–µ—Ä—ñ–≤


12. **–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏** –≤ –Ω–∞—Å—Ç—É–ø–Ω—ñ–π –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ:

  - **FILEBEAT –¥–ª—è (MonHub)**
     ```bash
     ansible-playbook  -u  your user -i inventories/_name_your_project_/infra.yaml --private-key=/path/your/key filebeat_install.yaml
     ```

- **Zabbix Agent2 –¥–ª—è (MonHub)**
     ```bash
     ansible-playbook  -u  your user -i inventories/_name_your_project_/infra.yaml --private-key=/path/your/key mon_zabbix.yaml
     ```

  - **UXP Security Server (–®–ë–û)**

    ```bash
    ansible-playbook  -u  your user -i inventories/_name_your_project_/infra.yaml --private-key=/path/your/key ss_install.yaml
    ```

  - **MinIO**

     ```bash
     ansible-playbook  -u  your user -i inventories/_name_your_project_/infra.yaml --private-key=/path/your/key minio_install.yaml
     ```

  - **Elasticsearch + Kibana**

     ```bash
     ansible-playbook  -u  your user -i inventories/_name_your_project_/infra.yaml --private-key=/path/your/key ek_install.yaml
     ```

> ‚ö†Ô∏è **–£–≤–∞–≥–∞!** –ü—ñ–¥ —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è `ansible-playbook` **–ø–∞—Ä–æ–ª—å** –¥–æ –≤–µ–±—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É Kibana –≥–µ–Ω–µ—Ä—É—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —ñ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è —É –≤–∏–≤–æ–¥—ñ –ø—ñ—Å–ª—è **—É—Å–ø—ñ—à–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è**. –ó–∞ –ø–æ—Ç—Ä–µ–±–∏ –ø–∞—Ä–æ–ª—å –º–æ–∂–Ω–∞ –∑–º—ñ–Ω–∏—Ç–∏.

   
  - **Zabbix**

     ```bash
     ansible-playbook  -u  your user -i inventories/_name_your_project_/infra.yaml --private-key=/path/your/key zabbix_install.yaml
     ```
     
  - **Graylog**
    
     ```bash
     ansible-playbook  -u  your user -i inventories/_name_your_project_/infra.yaml --private-key=/path/your/key graylog_install.yaml
     ```
---

## üñ•Ô∏è –î–æ–≤—ñ–¥–Ω–∏–∫ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤

- **UXP Security Server (–®–ë–û)**

    ```bash
    https://<security-server>:4000
    ```
> üîê **–ü—Ä–∏–º—ñ—Ç–∫–∞** <br>
> –õ–æ–≥—ñ–Ω - `uxpadmin` <br>
> –ü–∞—Ä–æ–ª—å –∑–∞–¥–∞—î—Ç—å—Å—è —É —Ñ–∞–π–ª—ñ `all.yaml` <br>

- **MinIO**

     ```bash
     https://<security-server>:2001
     ```

> üîê **–ü—Ä–∏–º—ñ—Ç–∫–∞** <br>
> –õ–æ–≥—ñ–Ω –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º - `minio` (–ê–∫—Ç—É–∞–ª—å–Ω–∏–π –ª–æ–≥—ñ–Ω –∑–∞–¥–∞—î—Ç—å—Å—è —É —Ñ–∞–π–ª—ñ `all.yaml`) <br>
> –ü–∞—Ä–æ–ª—å –∑–∞–¥–∞—î—Ç—å—Å—è —É —Ñ–∞–π–ª—ñ `all.yaml` <br>


- **Elasticsearch + Kibana**

     ```bash
     https://<security-server>:5601
     ```
> üîê **–ü—Ä–∏–º—ñ—Ç–∫–∞** <br>
> –õ–æ–≥—ñ–Ω - `elastic` <br>
> –ü–∞—Ä–æ–ª—å –≥–µ–Ω–µ—Ä—É—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —ñ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è —É –≤–∏–≤–æ–¥—ñ –ø—ñ—Å–ª—è **—É—Å–ø—ñ—à–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è** `ansible-playbook` <br>

  
- **Zabbix**

     ```bash
     http://<security-server>:8080
     ```

> üîê **–ü—Ä–∏–º—ñ—Ç–∫–∞** <br>
> –õ–æ–≥—ñ–Ω - `Admin` <br>
> –ü–∞—Ä–æ–ª—å - `zabbix` <br>

     
- **Graylog**
    
     ```bash
     https://<graylog-server-address>
     ```

> üîê **–ü—Ä–∏–º—ñ—Ç–∫–∞** <br>
> –õ–æ–≥—ñ–Ω - `admin` <br>
> –ü–∞—Ä–æ–ª—å –∑–∞–¥–∞—î—Ç—å—Å—è —É —Ñ–∞–π–ª—ñ `all.yaml` <br>

